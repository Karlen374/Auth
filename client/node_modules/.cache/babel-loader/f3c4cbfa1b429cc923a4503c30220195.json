{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport AuthService from '../../services/AuthService';\nimport axios from 'axios';\nimport { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport useWeatherServices from '../../services/WeatherApi';\nconst initialState = {\n  email: '',\n  password: '',\n  auth: false,\n  user: {},\n  spinner: false,\n  data: []\n};\nexport const checkAuth = createAsyncThunk('login/checkAuth', async () => {\n  const response = await axios.get(`http://localhost:5000/api/refresh`, {\n    withCredentials: true\n  });\n  return response;\n});\nexport const registrationUser = createAsyncThunk('login/registrationUser', async state => {\n  const response = await AuthService.registration(state.email, state.password);\n  return response;\n});\nexport const loginUser = createAsyncThunk('login/loginUser', async state => {\n  const response = await AuthService.login(state.email, state.password);\n  return response;\n});\nexport const searchCity = _s(createAsyncThunk('login/searchCity', _s(async state => {\n  _s();\n\n  const {\n    getWeatherByCity\n  } = useWeatherServices();\n  const response = await getWeatherByCity(state);\n  console.log(response);\n  return response;\n}, \"Zw2WUmbvtFAN4IWB85tUxg+sMu4=\", false, function () {\n  return [useWeatherServices];\n})), \"Zw2WUmbvtFAN4IWB85tUxg+sMu4=\", false, function () {\n  return [useWeatherServices];\n});\nconst LoginSlice = createSlice({\n  name: 'login',\n  initialState,\n  reducers: {\n    logout: async state => {\n      try {\n        const response = await AuthService.logout();\n        localStorage.removeItem('token');\n        state.auth = false;\n        state.user = {};\n      } catch (e) {\n        var _e$response, _e$response$data;\n\n        console.log((_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.message);\n      }\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(checkAuth.pending, state => {\n      state.spinner = true;\n    }).addCase(checkAuth.fulfilled, (state, action) => {\n      localStorage.setItem('token', action.payload.data.accessToken);\n      state.auth = true;\n      state.spinner = false;\n      state.user = action.payload.data.user;\n    }).addCase(checkAuth.rejected, (state, action) => {\n      var _action$error;\n\n      state.spinner = false;\n      console.log(action === null || action === void 0 ? void 0 : (_action$error = action.error) === null || _action$error === void 0 ? void 0 : _action$error.message);\n    }).addCase(registrationUser.pending, state => {\n      state.spinner = true;\n    }).addCase(registrationUser.fulfilled, (state, action) => {\n      localStorage.setItem('token', action.payload.data.accessToken);\n      state.auth = true;\n      state.spinner = false;\n      state.user = action.payload.data.user;\n    }).addCase(registrationUser.rejected, (state, action) => {\n      var _action$error2;\n\n      console.log(action === null || action === void 0 ? void 0 : (_action$error2 = action.error) === null || _action$error2 === void 0 ? void 0 : _action$error2.message);\n    }).addCase(loginUser.fulfilled, (state, action) => {\n      localStorage.setItem('token', action.payload.data.accessToken);\n      state.auth = true;\n      state.user = action.payload.data.user;\n    }).addCase(loginUser.rejected, (state, action) => {\n      var _action$error3;\n\n      console.log(action === null || action === void 0 ? void 0 : (_action$error3 = action.error) === null || _action$error3 === void 0 ? void 0 : _action$error3.message);\n    }).addCase(searchCity.pending, (state, action) => {\n      console.log('Download');\n    }).addCase(searchCity.fulfilled, (satet, action) => {\n      console.log('sucsess');\n    }).addDefaultCase(() => {});\n  }\n});\nconst {\n  actions,\n  reducer\n} = LoginSlice;\nexport default reducer;\nexport const {\n  logout\n} = actions;","map":{"version":3,"sources":["C:/Users/svary/OneDrive/Рабочий стол/Auth/client/src/components/weatherList/WeatherSlice.js"],"names":["AuthService","axios","createSlice","createAsyncThunk","useWeatherServices","initialState","email","password","auth","user","spinner","data","checkAuth","response","get","withCredentials","registrationUser","state","registration","loginUser","login","searchCity","getWeatherByCity","console","log","LoginSlice","name","reducers","logout","localStorage","removeItem","e","message","extraReducers","builder","addCase","pending","fulfilled","action","setItem","payload","accessToken","rejected","error","satet","addDefaultCase","actions","reducer"],"mappings":"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","sourcesContent":["import AuthService from '../../services/AuthService'\r\nimport axios from 'axios'\r\nimport {createSlice,createAsyncThunk} from \"@reduxjs/toolkit\"\r\nimport useWeatherServices from '../../services/WeatherApi'\r\n\r\nconst initialState = {\r\n  email:'',\r\n  password:'',\r\n  auth:false,\r\n  user:{},\r\n  spinner:false,\r\n  data:[]\r\n}\r\n\r\n\r\nexport const checkAuth = createAsyncThunk(\r\n  'login/checkAuth',\r\n  async () => {\r\n      const response= await axios.get(`http://localhost:5000/api/refresh`, { withCredentials: true })\r\n      return  response\r\n  }\r\n);\r\nexport const registrationUser=createAsyncThunk(\r\n  'login/registrationUser',\r\n  async(state)=>{\r\n    const response = await AuthService.registration(state.email, state.password);\r\n    return response\r\n  }\r\n)\r\nexport const loginUser=createAsyncThunk(\r\n  'login/loginUser',\r\n  async(state)=>{\r\n    const response = await AuthService.login(state.email, state.password);\r\n    return response;\r\n  }\r\n)\r\nexport const searchCity=createAsyncThunk(\r\n  'login/searchCity',\r\n  async(state)=>{\r\n    const {getWeatherByCity}=useWeatherServices();\r\n    const response= await getWeatherByCity(state)\r\n    console.log(response)\r\n    return response\r\n  }\r\n)\r\nconst LoginSlice=createSlice({\r\n  name:'login',\r\n  initialState,\r\n  reducers:{\r\n  logout:async(state)=>{\r\n    try {\r\n      const response = await AuthService.logout();\r\n      localStorage.removeItem('token');\r\n      state.auth=false;\r\n      state.user={};\r\n    }\r\n    catch (e) {\r\n      console.log(e.response?.data?.message);\r\n    }\r\n  },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n        .addCase(checkAuth.pending,(state)=>{\r\n          state.spinner=true;\r\n        })\r\n        .addCase(checkAuth.fulfilled, (state, action) => {\r\n          localStorage.setItem('token', action.payload.data.accessToken);\r\n          state.auth=true;\r\n          state.spinner=false;\r\n          state.user=action.payload.data.user \r\n        })\r\n        .addCase(checkAuth.rejected, (state,action) => {\r\n            state.spinner=false;\r\n            console.log(action?.error?.message)\r\n        })\r\n\r\n        .addCase(registrationUser.pending,(state)=>{\r\n          state.spinner=true;\r\n        })\r\n        .addCase(registrationUser.fulfilled, (state,action)=>{\r\n          localStorage.setItem('token',action.payload.data.accessToken );\r\n          state.auth=true;\r\n          state.spinner=false;\r\n          state.user=action.payload.data.user \r\n        })\r\n        .addCase(registrationUser.rejected,(state,action)=>{\r\n          console.log(action?.error?.message)\r\n        })\r\n\r\n        .addCase(loginUser.fulfilled,(state,action)=>{\r\n          localStorage.setItem('token', action.payload.data.accessToken);\r\n          state.auth=true;\r\n          state.user=action.payload.data.user\r\n        })\r\n        .addCase(loginUser.rejected,(state,action)=>{\r\n          console.log(action?.error?.message)\r\n        })\r\n\r\n        .addCase(searchCity.pending,(state,action)=>{\r\n          console.log('Download')\r\n        })\r\n        .addCase(searchCity.fulfilled,(satet,action)=>{\r\n          console.log('sucsess')\r\n        })\r\n        .addDefaultCase(() => {})\r\n}\r\n})\r\n\r\nconst {actions, reducer} = LoginSlice;\r\n\r\nexport default reducer;\r\n\r\nexport const {\r\n   logout,\r\n} = actions;"]},"metadata":{},"sourceType":"module"}